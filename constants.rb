require 'set'

PATRONS_MAP = JSON.parse('{"adlungda":["desligis"],"ahrensja":["zenkju","lenzlu"],"ahrensjo1":["kraifra"],"ahrensst":["schmiger"],"altbe":["mickelja","diebelph"],"barthni":["diebelph"],"baumma":["reinhaca","kellertr"],"bednarad":["serafiju","hoffmama"],"berndtke":["baumma","espefr"],"bertscma":["brassro","haliloam"],"binderse":["widmeral","hoffmama","trodlela"],"blumesi":["reithme","wallbami","rayhermi"],"bortelle":["erdmanli","trodlela"],"brassro":["haliloam","bertscma","kummerhe"],"braunro":["burgahva","maierna"],"broderti":["raafbe"],"burgahva":["braunro","kraussre","kummerhe"],"burgerma":["neidhach","elgogoli"],"cussaceg":["hoffmelo","moyrerma"],"demskiph":["serafiju","bednarad"],"desligis":["kraifra","schuckpa"],"diebelph":["mickelja","altbe","fuerbaal","mengesan"],"diekmajo":["zoellest"],"doersafe":["weberpi"],"doldtva":["wottrilu","schubale","mbalapr","grossma"],"eberhada":["reicheni","guenthja"],"elgogoli":["burgerma","goerkeja"],"erdmanli":["saurde","wallbami","richtesa","leikerch"],"espefr":["werrnal","haitzth"],"famalo":["serafiju","happleva","hoffmale"],"feyjo":["zobersal","thalma"],"freytada":["doersafe","weberpi"],"friebosa":["hoffmale","wolfpa"],"fuerbaal":["mengesan","mercanze"],"glutscse":["mahlerda"],"goerkeja":["strausfe","elgogoli","rayhermi"],"grossma":["schubale","wottrilu","mbalapr","doldtva"],"grunzva":["renkerje"],"guenthja":["reicheni","eberhada"],"haitzth":["leikerch","wolfstjo","espefr"],"halaszev":["wolfstjo","talleuse","schubakr"],"haliloam":["brassro","bertscma"],"hantscjo":["heckelle"],"happleva":["braunro","famalo","trodlela"],"heckelle":["rennervi","schauban"],"henkensa":["urbanbe","lauberlu","kraussre"],"herzogfr":["schoepre","strausfe"],"hoffmale":["wolfpa","friebosa","famalo","sickka"],"hoffmama":["serafiju","bednarad"],"hoffmelo":["cussaceg","moyrerma"],"ihlingju":["janosoka"],"ingentjo":["adlungda"],"jakobka":["kraussre","henkensa"],"janosoka":["heckelle","hantscjo"],"johnerph":["wetzelma"],"jurgscpa":["cussaceg","lenzlu"],"kappenla":["hoffmama","trodlela","keilbasa"],"keilbasa":["sailerma","kappenla","kulpast"],"kellertr":["tothpa","baumma"],"krafftju":["bortelle","trodlela"],"kraifra":["wetzelma","ahrensjo1"],"kramerlu":["kummerhe","widmeral"],"kraussre":["burgahva","henkensa","urbanbe","jakobka"],"kulpast":["mercanze","keilbasa"],"kummerhe":["widmeral","burgahva","wallbami"],"kunstqu":["wetzelma","ihlingju"],"lappena":["neidhach","weilerki"],"lauberlu":["maierna","waeldean","henkensa"],"lehmanma":["meissnna","sailerma"],"leikerch":["saurde","erdmanli","richtesa"],"lenzlu":["jurgscpa","cussaceg"],"mahlerda":["weilerki"],"maierna":["lauberlu","waeldean","nguetsva"],"masuchpa":["zielfa","broderti","ingentjo"],"mavridch":["guenthja"],"mbalapr":["grossma","schubale","wottrilu","doldtva"],"mehlhajo":["wolffrda"],"meissnna":["lehmanma","wolfstjo"],"mengesan":["schneijo","diebelph","fuerbaal"],"mercanze":["zimmerno","schneijo","kulpast","fuerbaal"],"mickelja":["altbe","diebelph","haitzth","leikerch"],"milgerth":["zielfa","masuchpa"],"moellefa":["trodlela"],"moyrerma":["hoffmelo","cussaceg"],"neidhach":["herzogfr"],"nguetsva":["waeldean","maierna","elgogoli"],"petrasju":["uenalde","vanhofhe"],"pfirrmmi":["schalwme"],"phanthsa":["winteran","schoepre"],"raafbe":["adlungda","ingentjo"],"rayhermi":["weberha","goerkeja"],"reichefa":["renkerje"],"reicheni":["eberhada","guenthja"],"reinhaca":["baumma","kellertr"],"reissimi":["schalwme","wolffrda"],"reistesa":["zoellest"],"reithme":["wessinin","blumesi"],"renkerje":["wolfpa","hoffmale","friebosa","moellefa"],"rennervi":["sailerma","wegneral","heckelle"],"richtesa":["saurde","erdmanli","leikerch","wallbami"],"rodrigjo":["uenalde"],"rubyan":["weberpi"],"sailerma":["keilbasa","wegneral","rennervi"],"saurde":["leikerch","erdmanli","richtesa"],"schaefti":["doersafe","freytada"],"schalwme":["hoffmelo","moyrerma"],"schauban":["heckelle","rennervi"],"schmiger":["ahrensst","kunstqu"],"schneijo":["schoepre","kraussre","kramerlu","warmutlu"],"schoepre":["phanthsa","winteran","herzogfr"],"schubakr":["wolfstjo","talleuse","halaszev"],"schubale":["mbalapr"],"schuckpa":["hoffmama","schauban","desligis","ingentjo"],"serafiju":["famalo","hoffmama","sickka","bednarad"],"sickka":["hoffmale","serafiju","famalo"],"strausfe":["zielfa","goerkeja"],"talleuse":["wolfstjo","schubakr","halaszev"],"tazeme":["wolfpa","lauberlu"],"thalma":["zobersal","feyjo"],"tothpa":["zielfa","kellertr"],"trodlela":["erdmanli","serafiju","bortelle"],"troesja":["haitzth","leikerch"],"uenalde":["vanhofhe","petrasju"],"urbanbe":["wallbami","kraussre","henkensa"],"vanhofhe":["petrasju","uenalde"],"waeldean":["maierna","lauberlu","braunro"],"wallbami":["urbanbe","kummerhe","erdmanli","henkensa"],"warmutlu":["schneijo","kramerlu"],"weberha":["rayhermi","goerkeja"],"weberpi":["wegneral","schneijo"],"wegneral":["wetzelma","rennervi"],"weilerki":["werrnal","lappena"],"werrnal":["espefr","zimmerno"],"wessinin":["werrnal","winteran","reithme"],"wetzelma":["johnerph","kraifra"],"widmeral":["kummerhe","guenthja"],"winteran":["schoepre","phanthsa","haitzth"],"wolffrda":["mehlhajo"],"wolfpa":["friebosa","hoffmale"],"wolfstjo":["talleuse"],"wottrilu":["schubale","doldtva","mbalapr","grossma"],"zenkju":["rubyan"],"zielfa":["schoepre","winteran"],"zimmerno":["mercanze"],"zobersal":["feyjo"],"zoellest":["reistesa"]}')
SYMMETRICAL_CONNECTION_MAP = PATRONS_MAP.reduce({}) do |acc, person|
  person.last.each do |author|
    acc[author] ||= Set.new
    acc[author].add(person.first)

    acc[person.first] ||= Set.new
    acc[person.first].add(author)
  end
  acc
end
